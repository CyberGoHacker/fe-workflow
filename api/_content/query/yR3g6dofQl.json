{"_path":"/docs/code","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"代码优化","description":"代码优化","excerpt":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"代码优化"},"children":[{"type":"text","value":"代码优化"}]},{"type":"element","tag":"h2","props":{"id":"vue-代码方面"},"children":[{"type":"text","value":"Vue 代码方面"}]},{"type":"element","tag":"h4","props":{"id":""},"children":[]},{"type":"element","tag":"h2","props":{"id":"javascript-代码方面"},"children":[{"type":"text","value":"JavaScript 代码方面"}]},{"type":"element","tag":"h4","props":{"id":"使用文档碎片"},"children":[{"type":"text","value":"使用文档碎片"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"将需要添加的大量元素 先添加到文档碎片 中，再将文档碎片添加到需要插入的位置，大大减少dom操作，提高性能"}]},{"type":"element","tag":"code","props":{"code":"let domFragment = document.createDocumentFragment()\n\nfor(let i = 0; i < 10000; i++) {\n  let domSpan = document.createElement('span')\n  let domText = document.createTextNode(i)\n  domSpan.appendChild(domText)\n  domFragment.appendChild(domSpan)\n}\n\ndocument.body.appendChild(domFragment)\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"let domFragment = document.createDocumentFragment()\n\nfor(let i = 0; i < 10000; i++) {\n  let domSpan = document.createElement('span')\n  let domText = document.createTextNode(i)\n  domSpan.appendChild(domText)\n  domFragment.appendChild(domSpan)\n}\n\ndocument.body.appendChild(domFragment)\n"}]}]}]},{"type":"element","tag":"h4","props":{"id":"垃圾收集内存管理"},"children":[{"type":"text","value":"垃圾收集、内存管理"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"堆内存：数据不再有用，将其值设置为null"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"栈内存：把上下文中，被外部占用的堆的占用取消即可"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"在 JS 中，常见的内存泄露主要有 4 种,全局变量、闭包、DOM 元素的引用、定时器"}]}]},{"type":"element","tag":"code","props":{"code":"function fn() {\n  let el = $(\"#el\")\n  el.click(function(){})\n  el = null\n}\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"function fn() {\n  let el = $(\"#el\")\n  el.click(function(){})\n  el = null\n}\n"}]}]}]},{"type":"element","tag":"h2","props":{"id":"css-代码方面"},"children":[{"type":"text","value":"Css 代码方面"}]},{"type":"element","tag":"h4","props":{"id":"避免出现重绘重排"},"children":[{"type":"text","value":"避免出现重绘、重排"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"集中改变样式，不要一条一条地修改 DOM 的样式;"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"不要把 DOM 结点的属性值放在循环里当成循环里的变量;"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"为动画的 HTML 元件使用 fixed 或 absoult 的 position，那么修改他们的 CSS 是不会 reflow 的;"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"不使用 table 布局。因为可能很小的一个小改动会造成整个 table 的重新布局；"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"动画开始GPU加速，translate使用3D变化；"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"将元素提升为合成层："},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"合成层的位图，会交由 GPU 合成，比 CPU 处理要快;"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"当需要 repaint 时，只需要 repaint 本身，不会影响到其他的层;"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"对于 transform 和 opacity 效果，不会触发 layout 和 paint"}]}]},{"type":"element","tag":"code","props":{"code":"<!-- 提升合成层的最好方式是使用 CSS 的 will-change 属性： -->\n#target {\n    will-change: transform;\n}\n","language":"css"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"<!-- 提升合成层的最好方式是使用 CSS 的 will-change 属性： -->\n#target {\n    will-change: transform;\n}\n"}]}]}]}]}]}]},"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"代码优化"},"children":[{"type":"text","value":"代码优化"}]},{"type":"element","tag":"h2","props":{"id":"vue-代码方面"},"children":[{"type":"text","value":"Vue 代码方面"}]},{"type":"element","tag":"h4","props":{"id":""},"children":[]},{"type":"element","tag":"h2","props":{"id":"javascript-代码方面"},"children":[{"type":"text","value":"JavaScript 代码方面"}]},{"type":"element","tag":"h4","props":{"id":"使用文档碎片"},"children":[{"type":"text","value":"使用文档碎片"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"将需要添加的大量元素 先添加到文档碎片 中，再将文档碎片添加到需要插入的位置，大大减少dom操作，提高性能"}]},{"type":"element","tag":"code","props":{"code":"let domFragment = document.createDocumentFragment()\n\nfor(let i = 0; i < 10000; i++) {\n  let domSpan = document.createElement('span')\n  let domText = document.createTextNode(i)\n  domSpan.appendChild(domText)\n  domFragment.appendChild(domSpan)\n}\n\ndocument.body.appendChild(domFragment)\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" domFragment "}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" document."}]},{"type":"element","tag":"span","props":{"class":"ct-ddddc7"},"children":[{"type":"text","value":"createDocumentFragment"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ee4a37"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"; i "}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ee4a37"},"children":[{"type":"text","value":"10000"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"; i"}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"++"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":") {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" domSpan "}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" document."}]},{"type":"element","tag":"span","props":{"class":"ct-ddddc7"},"children":[{"type":"text","value":"createElement"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-16ea78"},"children":[{"type":"text","value":"'span'"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" domText "}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" document."}]},{"type":"element","tag":"span","props":{"class":"ct-ddddc7"},"children":[{"type":"text","value":"createTextNode"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"(i)"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"  domSpan."}]},{"type":"element","tag":"span","props":{"class":"ct-ddddc7"},"children":[{"type":"text","value":"appendChild"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"(domText)"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"  domFragment."}]},{"type":"element","tag":"span","props":{"class":"ct-ddddc7"},"children":[{"type":"text","value":"appendChild"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"(domSpan)"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"document.body."}]},{"type":"element","tag":"span","props":{"class":"ct-ddddc7"},"children":[{"type":"text","value":"appendChild"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"(domFragment)"}]}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"垃圾收集内存管理"},"children":[{"type":"text","value":"垃圾收集、内存管理"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"堆内存：数据不再有用，将其值设置为null"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"栈内存：把上下文中，被外部占用的堆的占用取消即可"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"在 JS 中，常见的内存泄露主要有 4 种,全局变量、闭包、DOM 元素的引用、定时器"}]}]},{"type":"element","tag":"code","props":{"code":"function fn() {\n  let el = $(\"#el\")\n  el.click(function(){})\n  el = null\n}\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"function"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ddddc7"},"children":[{"type":"text","value":"fn"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"() {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" el "}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ddddc7"},"children":[{"type":"text","value":"$"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-16ea78"},"children":[{"type":"text","value":"\"#el\""}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"  el."}]},{"type":"element","tag":"span","props":{"class":"ct-ddddc7"},"children":[{"type":"text","value":"click"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"function"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"(){})"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"  el "}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ee4a37"},"children":[{"type":"text","value":"null"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"css-代码方面"},"children":[{"type":"text","value":"Css 代码方面"}]},{"type":"element","tag":"h4","props":{"id":"避免出现重绘重排"},"children":[{"type":"text","value":"避免出现重绘、重排"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"集中改变样式，不要一条一条地修改 DOM 的样式;"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"不要把 DOM 结点的属性值放在循环里当成循环里的变量;"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"为动画的 HTML 元件使用 fixed 或 absoult 的 position，那么修改他们的 CSS 是不会 reflow 的;"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"不使用 table 布局。因为可能很小的一个小改动会造成整个 table 的重新布局；"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"动画开始GPU加速，translate使用3D变化；"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"将元素提升为合成层："},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"合成层的位图，会交由 GPU 合成，比 CPU 处理要快;"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"当需要 repaint 时，只需要 repaint 本身，不会影响到其他的层;"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"对于 transform 和 opacity 效果，不会触发 layout 和 paint"}]}]},{"type":"element","tag":"code","props":{"code":"<!-- 提升合成层的最好方式是使用 CSS 的 will-change 属性： -->\n#target {\n    will-change: transform;\n}\n","language":"css"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"<!-- 提升合成层的最好方式是使用 CSS 的 "}]},{"type":"element","tag":"span","props":{"class":"ct-1904e7"},"children":[{"type":"text","value":"will-change"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" 属性： --"}]},{"type":"element","tag":"span","props":{"class":"ct-f6ed85"},"children":[{"type":"text","value":">"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-ee4a37"},"children":[{"type":"text","value":"#target"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":" {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-ee4a37"},"children":[{"type":"text","value":"will-change"}]},{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":": transform;"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a470ca"},"children":[{"type":"text","value":"}"}]}]}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-1904e7{color:#8DDB8C}.ct-16ea78{color:#96D0FF}.ct-ee4a37{color:#6CB6FF}.ct-ddddc7{color:#DCBDFB}.ct-a470ca{color:#ADBAC7}.ct-f6ed85{color:#F47067}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"vue-代码方面","depth":2,"text":"Vue 代码方面"},{"id":"javascript-代码方面","depth":2,"text":"JavaScript 代码方面"},{"id":"css-代码方面","depth":2,"text":"Css 代码方面"}]}},"_type":"markdown","_id":"content:docs:72.code.md","_source":"content","_file":"docs/72.code.md","_extension":"md"}